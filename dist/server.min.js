var express=require("express"),app=express(),morgan=require("morgan"),request=require("request"),config=require("./config"),bodyParser=require("body-parser");app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.set("view engine","ejs"),app.use(morgan("dev")),app.get("/",function(e,s){s.render("pages/index")}),app.get("/berwick",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&l=berwick%2C+pa&sort=&radius="+config.results_radius+"&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.get("/bloomsburg",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&l=bloomsburg%2C+pa&sort=&radius="+config.results_radius+"&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.get("/danville",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&l=danville%2C+pa&sort=&radius="+config.results_radius+"&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.get("/test/:city/:state",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&l="+e.params.city+"%2C+"+e.params.state+"&sort=&radius=&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/test",{searchTotalResults:a.totalResults,searchLocation:a.location,searchJobTitle:a.results[0].jobtitle,searchCompany:a.results[0].company,searchDate:a.results[0].date,searchSnippet:a.results[0].snippet,searchFormattedLocationFull:a.results[0].formattedLocationFull,searchRelativeTime:a.results[0].formattedRelativeTime,searchResults:a.results})}})}),app.post("/test/search",function(e,s){var t=e.body.jobQuery;request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&q="+t+"&l=bloomsburg%2C+pa&sort=&radius=&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);0===a.totalResults?s.redirect("/no-results"):s.render("pages/test",{searchTotalResults:a.totalResults,searchLocation:a.location,searchJobTitle:a.results[0].jobtitle,searchCompany:a.results[0].company,searchDate:a.results[0].date,searchSnippet:a.results[0].snippet,searchFormattedLocationFull:a.results[0].formattedLocationFull,searchRelativeTime:a.results[0].formattedRelativeTime,searchResults:a.results})}})}),app.get("/no-results",function(e,s){s.render("pages/no-results")}),app.get("/geisinger",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&q=geisinger&l=bloomsburg%2C+pa&sort=&radius=&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.get("/bloomsburg-university",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&q=bloomsburg%20university&l=bloomsburg%2C+pa&sort=&radius=&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.get("/berwick-hospital-center",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&q=berwick%20hospital&l=berwick%2C+pa&sort=&radius=&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.get("/wise-foods",function(e,s){request("http://api.indeed.com/ads/apisearch?publisher="+config.publisher_id+"&format=json&q=wise%20foods&l=berwick%2C+pa&sort=&radius=&st=&jt=&start=&limit="+config.results_limit+"&fromage=&filter=&latlong=1&co=us&chnl=&userip=1.2.3.4&useragent=Mozilla/%2F4.0%28Firefox%29&v=2",function(e,t,r){if(!e&&200==t.statusCode){var a=JSON.parse(r);s.render("pages/results",{searchLocation:a.location,searchResults:a.results})}})}),app.listen(config.port),console.log("App started! Look at port "+config.port);